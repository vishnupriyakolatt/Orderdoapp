"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.crc1=exports.hash=exports.verify=exports.sign=exports._hashSizes=void 0;const crypto_1=require("crypto"),IV=(0,crypto_1.randomBytes)(16);function sign(e,r,t=-1,s="sha512"){"string"==typeof e&&(e=Buffer.from(e,"utf8"));const o=exports._hashSizes[s],c=o+8,a=Buffer.allocUnsafe(c+e.length);a.writeDoubleLE(t,o),e.copy(a,c);const i=(0,crypto_1.createHmac)(s,r);return i.update(a.slice(o)),i.digest().copy(a),a}function verify(e,r,t="sha512"){"string"==typeof e&&(e=Buffer.from(e,"base64url"));var s=exports._hashSizes[t],o=e.slice(0,s);const c=e.readDoubleLE(s),a=(0,crypto_1.createHmac)(t,r);return a.update(e.slice(s)),{isValid:0===a.digest().compare(o),expires:c,data:e.slice(s+8)}}function hash(e,r,t="sha512"){"string"==typeof e&&(e=Buffer.from(e,"utf8"));const s=(0,crypto_1.createHmac)(t,r);return s.update(e),s.digest()}function crc1(e){"string"==typeof e&&(e=Buffer.from(e));var r=0;for(let t=0,s=e.length;t<s;++t)r+=e[t];return 255&r}exports._hashSizes={md5:16,sha1:20,sha256:32,sha512:64},exports.sign=sign,exports.verify=verify,exports.hash=hash,exports.crc1=crc1;